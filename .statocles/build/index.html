<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta content="width=device-width, initial-scale=1" name="viewport">
        <link href="/theme/css/normalize.css" rel="stylesheet">
        <link href="/theme/css/skeleton.css" rel="stylesheet">
        <link href="/theme/css/statocles-default.css" rel="stylesheet">
        <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
        <title>Joel Berger</title>
        <meta content="Joel Berger" name="author">
        <meta content="Statocles 0.093" name="generator">
        <link href="/blog/index.atom" rel="alternate" type="application/atom+xml">
        <link href="/blog/index.rss" rel="alternate" type="application/rss+xml">
        
    </head>
    <body>
        <header>
            <nav class="navbar">
                <div class="container">
                    <a class="brand" href="/">Joel Berger</a>
                    <ul>
                        <li>
                            <a href="/">Blog</a>
                        </li>
                    </ul>
                    
                </div>
            </nav>
            
        </header>
        <div class="main container">
            <div class="row">
                <div class="nine columns">
                    <main>
                        

<article>
    <header>
        <h1><a href="/blog/2017/10/02/on-gun-violence/">On Gun Violence</a></h1>

        <aside>
            <time datetime="2017-10-02">
                Posted on 2017-10-02
            </time>
                <span class="author">
                    by Joel Berger
                </span>
        </aside>

        <p class="tags">Tags:
            <a href="/blog/tag/politics/" rel="tag">politics</a>
            <a href="/blog/tag/guns/" rel="tag">guns</a>
        </p>

    </header>

    <p>I write this in the wake of the Las Vegas shooting.
I do so as the narrative is forming that perhaps the heinous act was committed by a Left-Wing extremist.
I don&#39;t care if he was &quot;on my side&quot;, no one that is killing people is &quot;on my side&quot;.</p>

<p>I don&#39;t want anyone shot.</p>

<p>I don&#39;t want Steve Scalise or Gabby Giffords shot.
I don&#39;t want country music fans, movie-goers, or gay men at a nightclub shot.
I don&#39;t want disaffected white men, or gang members shot.
I don&#39;t want college kids, high school kids, or innocent grade school kids shot.</p>

<p>And yet I know it will continue as long as people who want to own deadly weapons, even for good intentions, can do so.</p>

<p>If it turns out this madman was a Left-Winger, it doesn&#39;t change the fact that it was Right-Wingers that let him do it.
The ability to buy death at a WalMart did it; to buy it at a tent at a &quot;gun show&quot; and not even have a cursory background check did it.
The lack of regulation around carrying death on your waist did so; the laws that prevent you from infringing that &quot;right&quot; did so.</p>

<p>Now the right will say that good people with guns stop bad people with guns.
I&#39;d like to see that supported by evidence.
America has more guns than anywhere else, and always rising, and yet by far the most gun deaths.</p>

<p>Anecdotally I only have seen a few cases where a bystander with a gun stopped a shooter.
Those few are swamped by the stories of hot-heads with conceal-carry who lose their temper and become the bad guy rather than the good guy.
I remember video of a man at a gas station mad that the kids in the next car over had their music too loud, so he shot them.
Just one case, but I&#39;ll bet you find more of those than good guy saves the day.</p>

<p>And while I&#39;m on that topic, the good guy can&#39;t &quot;save the day&quot;, he can only make it less horrific.
Especially in states with open-carry, you can&#39;t know someone is the bad guy until they start shooting.
Which means the situation is always reactive.
If the shooter has any skill, people are already dead.
This isn&#39;t prevention, just a stop-gap, and a bad one.</p>

<p>So why do we have this situation?</p>

<p>Well the second amendment says that we have the right to bear arms.
There are basically two schools of thought on this, defense against others and defense against the government.</p>

<p>We&#39;ve seen above that it is doing a terrible job at the former.
And by the way, I don&#39;t even want to kill someone who would hurt me.
Why do all these defense nuts want to kill others so badly?
They should all be carrying Tasers!</p>

<p>And as to the latter, you and your buddies and your AK&#39;s aren&#39;t going to overthrow the US Government.
You just aren&#39;t.
You&#39;d at least need Howitzers and even then I&#39;m not so sure.</p>

<p>Even if you said it could be tried, what would that look like?
It isn&#39;t rows of men in uniforms with muskets.
It would look like Gabby Giffords and Steve Scalise.
Even Right-Wingers decried the latter attack, since this time the victim was someone &quot;on their side&quot;.</p>

<p>Would banning guns have problems, yeah.</p>

<p>You can&#39;t get them ALL, but you can get most of them.
And then you&#39;d know when you saw someone with them that the situation was already bad.
And people will still commit violence with knives and cars.
But they can&#39;t send death in all directions at large distances.
I&#39;m ok with that kind of progress.</p>

<p>Short of banning guns, we could at least have some controls.
Nearly all of the rights guaranteed to us by the constitution have limits.
There are answers to this problem!</p>

<p>So please can we end this?
I&#39;m tired of worrying about honking at a bad driver, what if they are pissed off and have gun?
I&#39;m tired of going to a movie and checking for exits, and more importantly, something solid to hide behind (yes I do that, you should too).
And mostly, I&#39;m tired of the cloaked blood-lust of the gun enthusiast, it is terrifying.</p>



</article>
<article>
    <header>
        <h1><a href="/blog/2017/06/02/when-the-sky-was-falling/">When the Sky was Falling</a></h1>

        <aside>
            <time datetime="2017-06-02">
                Posted on 2017-06-02
            </time>
                <span class="author">
                    by Joel Berger
                </span>
        </aside>

        <p class="tags">Tags:
            <a href="/blog/tag/politics/" rel="tag">politics</a>
            <a href="/blog/tag/governance/" rel="tag">governance</a>
            <a href="/blog/tag/climate/" rel="tag">climate</a>
            <a href="/blog/tag/science/" rel="tag">science</a>
        </p>

    </header>

    <p>It can be hard to convince someone that the state of the natural world is changing.
This can still be hard even when the change is occurring fast enough to see it with your own eyes.
What you need is a spectacle, an &quot;in your face&quot; demonstration that there is a problem and it is happening to <strong>us, now</strong>.
Pictures of melted glaciers aren&#39;t enough, it has to be present on your doorstep.</p>

<p>For a government that is so opposed to any government policy on climate and the environment, I propose this demonstration:</p>

<p>Step outside your door and breath in that clean air.</p>

<p>Is this not enough for them?
Ok maybe I need to remind the reader of some history.</p>

<p>In 1935 the Americna West was in crisis.
An influx of farmers had for decades been abusing the soil (to some extent unknowingly) to grow their crops.
On March 21, concerned politician Hugh Bennett was informed that a gigantic dust storm was sweeping east.
He timed a speech to Congress to finish as the storm entered into Washington D.C. itself.
His fellow politicians could no longer ignore the news reports, they had been forced to see with their own eyes.</p>

<p>Later though people knew that our rivers were being choked with waste, nothing happened until in 1969 the Cuyahoga River actually caught fire.
Though not as present, the obsurity and the shame of a river catching fire spurred action that has cleaned up much of our waterways and other environmentally impacted regions.
Similarly it wasn&#39;t until Los Angeles had become a national joke for its air quality that action was taken to improve it, including instituting the highest vehicle emissions standards in the country.</p>

<p>Why do I bring up these events from the past?
Because if you want to know why the government should be involved in environmental policy, the large &quot;in your face&quot; example is that the environment is cleaner today than it was when we let industry run amok.
The fact that dust storms, burning rivers, and haze-filled skies aren&#39;t daily problems anymore is a testament to that.</p>

<p>Famously China still faces these problems and so do other developing nations, and the is still much to do, both here and abroad.
But if I were Hugh Bennett reincarnate, I would throw the windows of the Capitol building open and let in the clean air as a showcase of why we MUST keep fighting for our environment.
Breath deeply, because our predecessors have fought so that you can.
And don&#39;t forget or abandon their work.</p>



</article>
<article>
    <header>
        <h1><a href="/blog/2017/05/08/freedom-of-religion-is-freedom-from-religion/">Freedom of Religion is Freedom From Religion</a></h1>

        <aside>
            <time datetime="2017-05-08">
                Posted on 2017-05-08
            </time>
                <span class="author">
                    by Joel Berger
                </span>
        </aside>

        <p class="tags">Tags:
            <a href="/blog/tag/politics/" rel="tag">politics</a>
            <a href="/blog/tag/governance/" rel="tag">governance</a>
            <a href="/blog/tag/religion/" rel="tag">religion</a>
        </p>

    </header>

    <p>It is a fast changing world.
Perhaps you are afraid you and your culture are being left behind.
Maybe you are afraid your religion is losing its place in your country and worse you fear that others might take its place.
It&#39;s scary.</p>

<p>Given that fear it can be natural to want the government to protect you.
Indeed the government should but how should that work?</p>

<p>Should you codify your religion, or the morality of your religion, into law?
That makes sense, quick article right?
Well, there&#39;s always a catch.</p>

<p>This mindset assumes that your religion has and will always have the majority.
As a member of a majority community, you might think that&#39;s a safe bet.
But in the back of your mind, remember, you had that fear that perhaps it isn&#39;t.</p>

<h2>Religious Restrictions</h2>

<p>What would happen if you were not in the religious majority in your area?
Would you want to be subject to the laws of another religion?
If your area was predominantly Mormon could you handle alcohol or coffee being banned?
If Hindu, what would happen if you were prohibited from eating beef?
If Muslim or Jewish could you tolerate bacon being banned?
What about prohibiting working on a Saturday?
What about changing the way the clock worked so that the day ended at sundown rather than midnight?</p>

<p>I&#39;m sure you&#39;ll agree that there are at least a few of those things that you&#39;d want to keep as they are!
I do too.
So do we make laws that say &quot;the sabbath can only be Sunday&quot; or &quot;beef cannot be banned&quot; or &quot;coffee is a right of the people&quot;?
You could, but if your group lost the majority, wouldn&#39;t the incoming faith change the law?
What would they change it to, would it be to neutrality or toward their belief?</p>

<p>Instead, what if it was ingrained in the culture and in the legal process that the law does not codify religious restrictions that don&#39;t harm others?
Now rather than undoing specifc laws about specific points, they would have to change the culture of religious independence.
That seems like it would be much harder to do.</p>

<h2>Religious &quot;Liberty&quot;</h2>

<p>A new phrase in America is &quot;religious liberty&quot;, meaning the right of a business to operate under the guidance of the religion of the owner or operator.
Again, this makes sense on the surface.
Why should you be compelled to serve a customer whose religious or moral beliefs are different from yours?</p>

<p>But again you have to ask yourself, are you willing to take what you dish out?
How would you feel if you went to a florist and they wouldn&#39;t sell you flowers if you weren&#39;t wearing a headscarf, or a yarmulke?
What if they wouldn&#39;t serve you food, or even speak to you, because you are a woman, or a married woman, or an unmarried woman?
What if a zoning board wouldn&#39;t let you build a house that didn&#39;t have a room to hold one year&#39;s food storage?</p>

<p>Should they be allowed to do that to you?
I suppose if you think your morality should be at liberty then so should theirs.</p>

<p>Would it be safer to say that we don&#39;t allow service to be refused based on the operator&#39;s morality?</p>

<h2>Freedom From Religion</h2>

<p>Live as your religion tells you, when the law doesn&#39;t codify it one way or the other then you are free to live that way.
Others might not live in your morality, if so, you may want to share your beliefs with them, so they can see why you live the way you do.
Some won&#39;t change, others might.</p>

<p>The government should protect you from changing religious affiliation, but it should do so by making sure all are free to live apart from religion.</p>

<p>And if you can&#39;t discriminate against them, then they can&#39;t discriminate you.
And if they wanted to change the laws it wouldn&#39;t be changing which discrimination is allowed, but allowing discrimination; something many would never stand for.</p>

<p>The only way you can be sure that you will continue to be free to practice your religion as you see fit, and to live and shop where you want, is to separate that from religion entirely.</p>



</article>
<article>
    <header>
        <h1><a href="/blog/2017/02/25/configuring-nginx-for-lets-encrypt.html">Configuring Nginx for Let&#39;s Encrypt</a></h1>

        <aside>
            <time datetime="2017-02-25">
                Posted on 2017-02-25
            </time>
                <span class="author">
                    by Joel Berger
                </span>
        </aside>

        <p class="tags">Tags:
            <a href="/blog/tag/web/" rel="tag">web</a>
            <a href="/blog/tag/security/" rel="tag">security</a>
            <a href="/blog/tag/perl/" rel="tag">perl</a>
            <a href="/blog/tag/nginx/" rel="tag">nginx</a>
            <a href="/blog/tag/letsencrypt/" rel="tag">letsencrypt</a>
        </p>

    </header>

    <p>Mojolicious apps can use <a href="https://metacpan.org/pod/Mojolicious::Plugin::ACME">Mojo::ACME</a> to help issue a certificate for a single appplication. It registers routes which handle the challenges and adds commands which requests new certificates. That said, once you have more than one application and/or multiple sites in the same nginx virtual host, having that capability as a per-application plugin becomes a hinderance not a help.</p>

<p>In this article I will show how you can use a dummy Mojolicious app to issue certs for all of your virtual hosts.</p>

<h2>The Dummy Application</h2>

<p>At least until I modify Mojo::ACME to provide a built-in dummy application server, you still need a very simple application which only loads the plugin.</p>

<pre><code># mojo-acme.pl

use Mojolicious::Lite;

plugin &#39;ACME&#39;;

app-&gt;start;
</code></pre>

<p>This application only needs to be running when issuing certificates. Start it on an unpriviledged port (say 8000) by running <code>$ perl mojo-acme.pl -l &#39;http://*:8000&#39;</code>.</p>

<p>Then add a virtual-host for it in your nginx configuration. Since the other applications reference it, it needs to be loaded early, so lets call it <code>01-mojo-acme</code>.</p>

<pre><code># /etc/nginx/sites-available/01-mojo-acme

upstream mojo-acme {
  server 127.0.0.1:8000;
}
</code></pre>

<h2>Application Virtual-Host Files</h2>

<p>Now for your other applications, start with a skeleton like the following:</p>

<pre><code># /etc/nginx/sites-available/myapp

upstream myapp {
  server 127.0.0.1:8080;
}
server {
  listen 80;
  server_name myapp.myhost.com;
  include /etc/nginx/common/http-redirects;
}
server {
  listen 443 ssl;
  server_name myapp.myhost.com;
  location / {
    proxy_pass http://myapp;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection &quot;upgrade&quot;;
    proxy_set_header Host $host;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_read_timeout 3600s;
  }
  include /etc/nginx/common/ssl-settings;
}
</code></pre>

<p>Each application should be named differently (this one is called <code>myapp</code>) and should use its own <code>server_name</code> (where this one is <code>myapp.myhost.com</code>). The bulk of this configuration is the standard <a href="http://mojolicious.org/perldoc/Mojolicious/Guides/Cookbook#Nginx">Mojolicious NGINX configuration</a>. There are a few major differences. The first is that it defines handlers both for port 80 (http) and port 443 (https). Each section includes a file from <code>/etc/nginx/common/</code> which is a folder you&#39;ll need to create.</p>

<p>In the port 80 section it includes a file which contains the following:</p>

<pre><code># /etc/nginx/common/http-redirects

location /.well-known/ {
  proxy_pass http://mojo-acme;
  proxy_http_version 1.1;
  proxy_set_header Upgrade $http_upgrade;
  proxy_set_header Connection &quot;upgrade&quot;;
  proxy_set_header Host $host;
  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
  proxy_set_header X-Forwarded-Proto $scheme;
}

location / {
  return 301 https://$server_name$request_uri;
}
</code></pre>

<p>This file does two things. It siphons http traffic bound for certificate challenges and it directs it to the dummy app we defined earlier. Then it takes all other http traffic and responds to requests with a redirect to https. This protects users from forgetting to type <code>https://</code> before your site name, their browser will take them to the SSL protected service automatically.</p>

<p>The port 443 section of the virtual-host file also includes a second file which should contain something like the following:</p>

<pre><code># /etc/nginx/common/ssl-settings

ssl_certificate     /path/to/cert.crt;
ssl_certificate_key /path/to/cert.key;
ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
ssl_ciphers         &#39;EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH&#39;;
ssl_dhparam         /path/to/dhparams.pem;
ssl_session_cache   shared:SSL:10m;
ssl_prefer_server_ciphers on;
</code></pre>

<p>This file tells the application where to find your certificate and key files as well as a file defining a set of Diffie-Hellman parameters. You can generate the latter by running <code>$ openssl dhparam -out /etc/nginx/ssl/dhparam.pem 2048</code> which will take a while. The certificate and key are generated by the ACME plugin, which will be explained soon.</p>

<p>The rest of the parameters configure the site to use recommended modern security practices. As of the writing of this post, that configuration earns an A rating from <a href="https://ssllabs.com">ssllabs.com</a> for the author&#39;s own sites.</p>

<p>Finally, there is no requirement that the target of the virtual-host application be a Mojolicious application. The author of this article has five virtual hosts in his current configuration. Three are Mojolicious applications, one is a PHP application, and one is a simple file-based NGINX service. The other two virtual-host configurations have difference of course, but they still include the two files and are identical in the port 80 configuration and ssl configuration.</p>

<h2>Issuing the Certificate</h2>

<p>If you haven&#39;t started the dummy app as shown above, do so now. Also be sure that all of your desired vitual hosts are configured as shown above and are enabled in nginx.</p>

<p>NOTE! Before you continue, know that on all of these commands you can pass a <code>-t</code> flag to use a testing server provided by Let&#39;s Encrypt. In this way you can try out the service without affecting your certificate issuance rate-limit. The test servers generate valid certificates but aren&#39;t signed, so they aren&#39;t very useful other than testing.</p>

<p>Now if you don&#39;t already have an account key with Let&#39;s Encrypt you can create one by running <code>$ perl mojo-acme.pl acme account register</code>. This will create a file called <code>account.key</code>. Keep this file safe, you will need it for issuing certificates and all other actions you ever take for these domains.</p>

<p>Finally to issue the certificates, run the command <code>$ perl mojo-acme.pl acme cert generate -a account.key -n mydomain mydomain.com myapp.mydomain.com myotherapp.mydomain.com</code>. The <code>-a</code> flag tells it where to find your account key file (where <code>account.key</code> in the working directory is the default). The <code>-n</code> flag tells it what to name the generated files; which is completely arbitrary. Finally pass all the domains that you want to issue the cert for. Customarily you would pass the toplevel domain first if you are including that one.</p>

<p>Once the certificates are generated, move the certs to the paths you listed in <code>/etc/nginx/common/ssl-settings</code>, or else change those paths to where you want those cerificate files to remain.</p>

<p>Finally, once you reload your nginx configuration (when using upstart this is <code>$ sudo service nginx reload</code>), your sites should all be available using the new certificates!</p>

<p>In 3 months you will need to reissue the certificates, but now you only need to run that same certificate issuance command and the new files will be generated! Indeed the remaining steps are simple enough that they could be a cron job that runs periodically (say every 2 months) to keep your certificates valid indefinitely.</p>

<p>For future reference, the example files are collected in a gist for ease of access at <a href="https://gist.github.com/jberger/d04cbfa20d3a269eb1f7868e2b1f432c">https://gist.github.com/jberger/d04cbfa20d3a269eb1f7868e2b1f432c</a>.</p>

<p>(Originally published at <a href="https://asyncthoughts.tumblr.com/post/157702503315/configuring-nginx-for-lets-encrypt">https://asyncthoughts.tumblr.com/post/157702503315/configuring-nginx-for-lets-encrypt</a>).</p>



</article>

<ul class="pager">
    <li class="prev">
            <button disabled>
                ← Older
            </button>
    </li>
    <li class="next">
            <button disabled>
                Newer →
            </button>
    </li>
</ul>




                    </main>
                </div>

                <div class="three columns sidebar">
                    
                        <nav id="tags">
        <h1>Tags</h1>
        <ul class="list-inline">
            <li><a href="/blog/tag/climate/">climate</a></li>
            <li><a href="/blog/tag/governance/">governance</a></li>
            <li><a href="/blog/tag/guns/">guns</a></li>
            <li><a href="/blog/tag/letsencrypt/">letsencrypt</a></li>
            <li><a href="/blog/tag/nginx/">nginx</a></li>
            <li><a href="/blog/tag/perl/">perl</a></li>
            <li><a href="/blog/tag/politics/">politics</a></li>
            <li><a href="/blog/tag/religion/">religion</a></li>
            <li><a href="/blog/tag/science/">science</a></li>
            <li><a href="/blog/tag/security/">security</a></li>
            <li><a href="/blog/tag/web/">web</a></li>
        </ul>
    </nav>

                            <h1>Feeds</h1>
        <ul class="list-inline">
            <li>
                <a href="/blog/index.atom" rel="alternate" type="application/atom+xml">
                    Atom
                </a>
            </li>
            <li>
                <a href="/blog/index.rss" rel="alternate" type="application/rss+xml">
                    RSS
                </a>
            </li>
        </ul>

                </div>
            </div>
        </div>
        <footer>
            
            <div class="container tagline">
                <a href="http://preaction.me/statocles">Made with Statocles</a><br>
                <a href="http://www.perl.org">Powered by Perl</a>
            </div>
        </footer>


    </body>
</html>
